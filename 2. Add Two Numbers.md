## first step

- 動かなかったので、答えを見た
- 間違えた理由は新しいノードの作り方。
- リストの末尾に不要なノードが作成されていた。
- 条件が以下の3つに分かれると思った
	- 2つのリスト両方のノードと繰り上がりを足す
	- 片方のリストのノードと繰り上がりを足す
	- 繰り上がりのみを代入する

(動かない)
```python
class Solution:
    def addTwoNumbers(self, l1: Optional[ListNode], l2: Optional[ListNode]) -> Optional[ListNode]:
        head = ListNode()
        node = head

        carry = 0
        while l1 and l2:
            two_digit_sum = l1.val + l2.val + carry
            if two_digit_sum > 9:
                carry = 1
                two_digit_sum %= 10
            else:
                carry = 0
            node.val = two_digit_sum
            node.next = ListNode()
            node = node.next
            l1 = l1.next
            l2 = l2.next
 
        if l1:
            remaining_node = l1
        elif l2:
            remaining_node = l2
        else:
            remaining_node = None   
        while remaining_node:
            digit = remaining_node.val + carry
            if digit > 9:
                digit %= 10
                carry = 1
            else:
                carry = 0
            node.val = digit
            node.next = ListNode()
            node = node.next
            remaining_node = remaining_node.next
        if carry:
            node.val = 1
        else:
            node = None
        return head
```

（動く）
```python
class Solution:
    def addTwoNumbers(self, l1: Optional[ListNode], l2: Optional[ListNode]) -> Optional[ListNode]:
        dummy = ListNode()
        node = dummy

        carry = 0
        while l1 and l2:
            digit = l1.val + l2.val + carry
            carry = digit // 10
            digit = digit % 10
            node.next = ListNode(digit)
            node = node.next
            l1 = l1.next
            l2 = l2.next

        if l1:
            remain = l1
        elif l2:
            remain = l2
        else:
            remain = None
        
        while remain:
            digit = remain.val + carry
            carry = digit // 10
            digit = digit % 10
            node.next = ListNode(digit)
            node = node.next
            remain = remain.next
        if carry:
            node.next = ListNode(1)
        return dummy.next
```


## second step

- neetcodeの解説を見た
- step1の3条件全てに一つのループで対応できるのがいい

```python
class Solution:
    def addTwoNumbers(self, l1: Optional[ListNode], l2: Optional[ListNode]) -> Optional[ListNode]:
        dummy = ListNode()
        node = dummy

        carry = 0
        while l1 or l2 or carry:
            val1 = l1.val if l1 else 0
            val2 = l2.val if l2 else 0
            digit = val1 + val2 + carry
            carry = digit // 10
            digit = digit % 10
            node.next = ListNode(digit)
            node = node.next
            l1 = l1.next if l1 else None
            l2 = l2.next if l2 else None
        return dummy.next

```

## third step


- `digit`と`carry`が計算される場所を変えた。
- `digit`は各ノードの数値なので、ノードを作る部分と近くで出現してほしい。
- `carry`は繰り上がりなので、イメージはループの最後あたりに出てくる感じ
- 三項演算子で`l1`と`l2`を進めていたが、読みづらいと思ったので変えた。

```python
class Solution:
    def addTwoNumbers(self, l1: Optional[ListNode], l2: Optional[ListNode]) -> Optional[ListNode]:
        def get_val(node):
            if node is None:
                return 0
            return node.val

        dummy_head = ListNode()
        prev_node = dummy_head

        carry = 0
        while l1 or l2 or carry:
            total = get_val(l1) + get_val(l2) + carry
            digit = total % 10
            node = ListNode(digit)
            prev_node.next = node
            prev_node = node
            if l1:
                l1 = l1.next
            if l2:
                l2 = l2.next
            carry = total // 10
        return dummy_head.next
```


## 4th step（解き直し）

```python
class Solution:
    def addTwoNumbers(self, l1: Optional[ListNode], l2: Optional[ListNode]) -> Optional[ListNode]:
        def get_node_val(node):
            if node is None:
                return 0
            return node.val
        
        dummy = ListNode()
        node = dummy

        carry = 0
        while l1 or l2 or carry:
            total = get_node_val(l1) + get_node_val(l2) + carry
            digit = total % 10
            node.next = ListNode(digit)
            node = node.next
            if l1:
                l1 = l1.next
            if l2:
                l2 = l2.next
            carry = total // 10
        return dummy.next
```


### 読んだコード


- https://github.com/hayashi-ay/leetcode/pull/24/files?short_path=c655c7f
	- ヘルパー関数が足し算の手法を簡略化して一文で書けるようにしていた
	- 特に参考になった
- https://github.com/lilnoahhh/leetcode/pull/6/files?short_path=c655c7f#diff-c655c7f146b306e01c4b8ca0d6739d1fcc21f08b78456fb0dbf415fca6864c5a
- https://github.com/katataku/leetcode/pull/4/files?short_path=c655c7f#diff-c655c7f146b306e01c4b8ca0d6739d1fcc21f08b78456fb0dbf415fca6864c5a
- https://github.com/yus-yus/leetcode/pull/5/files?short_path=db0664d#diff-db0664d10b06658b1888826ec2d9897d4368b9cf805b218c4068d870bfc7a7cf
- https://github.com/katsukii/leetcode/pull/4/files#diff-1b44c99ee8f55f25cb9d7ed5f2c0688fd9661b241fc8d1d943f25a3bcfb5c512
	- dummyを使わないやり方を知った


### 振り返り

- 1stepで解き切りたかった
- 最後まで諦めない
